---
title: "useShallowEqualSelector"
category: "util"
summary: 'Customized "react-redux" useSelector hook with shallowEqual equality function, an enhanced selector, and a fallback value.'
---

## Usage

#### 1. We can rewrite this big pile of repetitive shit

```javascript
import { useSelector, shallowEqual } from "react-redux";
const slice = useSelector(
  (state) => state.slice?.layer1?.[0]?.layer2,
  shallowEqual
);
```

like this:

```javascript
import { useSelector } from "@hooks";
const slice = useSelector("slice.layer1.[0].layer2");
```

Instead this time we import our custom hook as `useSelector` not the one from [`react-redux`](https://www.npmjs.com/package/react-redux).

<br />

#### 2. We can even rewrite this:

```javascript
const { slice1, slice2 } = useSelector(
  (state) => ({ slice1: state.slice1, slice2: state.slice2 }),
  shallowEqual
);
```

Like this:

```javascript
const [slice1, slice2] = useShallowEqualSelector(["slice1", "slice2"]);
```

<br />

## Source

```javascript
import { useDispatch, useSelector, shallowEqual } from "react-redux";
import __get from "lodash/get";

/**
 * Customized "react-redux" useSelector hook with shallowEqual equality function, an enhanced selector and a fallback value.
 * @param selector - state selector
 * @param fallback - fallback value in case the result was falsy value
 */

const useShallowEqualSelector = (selector, fallback) =>
  useSelector(
    typeof selector === "string"
      ? (state) => __get(state, selector)
      : Array.isArray(selector)
      ? (state) =>
          selector.reduce((acc, cv, key) => {
            acc.push(__get(state, cv));
            return acc;
          }, [])
      : selector,
    shallowEqual
  ) || fallback;

export { useShallowEqualSelector as useSelector };
```
